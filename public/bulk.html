<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Upload URL List to Train AI Bot</title>
  <link rel="stylesheet" href="/_next/static/css/081a0fca5a9bd20.css"/>
  <style>
    body { background:#0b1220; color:#dbe4ff; font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,sans-serif; padding:24px; }
    .container { max-width:1100px; margin:0 auto; }
    .row { display:flex; gap:16px; }
    .card { background:#0f172a; border:1px solid #1b2540; border-radius:8px; padding:16px; margin-bottom:16px; }
    .w-1 { flex:1 } .w-2 { flex:2 } .w-3 { flex:3 }
    input, textarea { width:100%; background:#0b1426; border:1px solid #1b2540; color:#dbe4ff; padding:10px 12px; border-radius:6px; }
    button { background:#2563eb; color:white; border:none; padding:10px 14px; border-radius:6px; cursor:pointer; }
    button:disabled{opacity:.5; cursor:not-allowed}
    .pill { padding:3px 8px; border-radius:999px; border:1px solid #1b2540; }
    .ok  { color:#22c55e; } .bad { color:#ef4444; }
    .mono { font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace }
    table { width:100%; border-collapse:collapse; }
    th,td { padding:8px 10px; border-bottom:1px solid #1b2540; vertical-align:top; }
    pre { white-space:pre-wrap; word-break:break-word; }
    table a { color:#dbe4ff; text-decoration:underline; }
    table a:hover { opacity:.85; }
    @media (max-width:900px){ .row{ flex-direction:column; } }
    .muted { opacity:.8 }
    .score { color:#22c55e; }
    .answer { white-space:pre-wrap; }
    .chips a { display:inline-block; margin-right:6px; margin-bottom:6px; border:1px solid #1b2540; border-radius:999px; padding:4px 8px; color:#dbe4ff; text-decoration:none; }
    .chips a:hover { background:#13203e; }
    .ver { font-size:12px; opacity:.8; margin-left:8px }
  </style>
</head>
<body>
<div class="container">

<h2>Upload URL List to Train AI Bot <span class="ver">v0.11</span></h2>

<!-- (everything else on your page stays as-is) -->

<!-- search tester (kept) -->
<div class="card">
  <h3 style="margin-top:4px;margin-bottom:8px">AI Search Tester</h3>
  <div class="row">
    <div class="w-3">
      <div><small>Query</small></div>
      <input id="query" placeholder="e.g. photography workshops in Coventry"/>
    </div>
    <div class="w-1">
      <div><small>topK</small></div>
      <input id="topk" value="8"/>
    </div>
    <div class="w-1" style="display:flex;align-items:flex-end">
      <button id="runSearch" style="width:100%">Run Search</button>
    </div>
  </div>
</div>

<div class="card">
  <div><small>Search Results (grouped by URL)</small></div>
  <table>
    <thead><tr><th style="width:120px">Best Score / Chunks</th><th>URL</th><th>Snippet</th></tr></thead>
    <tbody id="srows"></tbody>
  </table>
</div>

<div class="card">
  <div><small>Search Raw Response</small></div>
  <pre id="sraw" class="mono" style="white-space:pre-wrap;word-break:break-word"></pre>
</div>

<!-- NEW: JSON-LD Extractor tester (unchanged markup, but remember: "All" now returns everything) -->
<div class="card">
  <h3 style="margin:4px 0 12px">Extract structured content (JSON-LD)</h3>
  <div><small>URL</small></div>
  <input id="xurl" placeholder="https://example.com/some-page"/>

  <div style="margin-top:10px;display:flex;gap:10px;flex-wrap:wrap">
    <button class="xbtn" data-kind="events">Events/Courses</button>
    <button class="xbtn" data-kind="articles">Articles</button>
    <button class="xbtn" data-kind="products">Products</button>
    <button class="xbtn" data-kind="services">Services</button>
    <button class="xbtn" data-kind="all">All (includes Events)</button>
  </div>

  <div style="margin-top:10px"><small>Result</small></div>
  <pre id="xout" class="mono"></pre>
</div>

</div><!-- /container -->

<script>
// (The existing JS on your page remains the same; below is just the small bit
// that posts to /api/extract and shows the JSON.)

document.querySelectorAll('.xbtn').forEach(btn=>{
  btn.addEventListener('click', async ()=>{
    const url = document.getElementById('xurl').value.trim();
    const kind = btn.dataset.kind || 'all';
    const out = document.getElementById('xout');
    out.textContent = '…fetching…';
    try {
      const r = await fetch('/api/extract?kind='+encodeURIComponent(kind), {
        method:'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify({ url })
      });
      const j = await r.json().catch(()=>({ error:'non_json', status:r.status }));
      out.textContent = JSON.stringify(j, null, 2);
    } catch (e) {
      out.textContent = JSON.stringify({ error:'fetch_failed', detail:String(e) }, null, 2);
    }
  });
});
</script>
</body>
</html>
