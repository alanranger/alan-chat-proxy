<!-- AR | Site Search Results | v1.2 | Uses /api/search/query (chat ranking/confidence) -->
<div id="ar-site-search"></div>
<link rel="stylesheet" href="/ar-site-search.css">
<script src="/ar-site-search.js"></script>
<script>
  (function(){
    function getParam(key){
      return new URLSearchParams(window.location.search).get(key) || "";
    }
    function waitForARSiteSearch(maxWaitMs, intervalMs, onReady){
      var start = Date.now();
      (function poll(){
        if (window.ARSiteSearch && typeof window.ARSiteSearch.mount === "function"){
          onReady();
          return;
        }
        if (Date.now() - start >= maxWaitMs) return;
        setTimeout(poll, intervalMs);
      })();
    }
    function mountSearch(){
      var root = document.getElementById("ar-site-search");
      if (!root) return;
      var q = getParam("q");
      window.ARSiteSearch.mount(root, {
        initialQuery: q,
        autoSearch: true,
        autoFocus: !q
      });
    }
    waitForARSiteSearch(6000, 150, mountSearch);
  })();
</script>
