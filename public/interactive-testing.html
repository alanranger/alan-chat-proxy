<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Chat Bot Testing</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .question {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #2196f3;
        }
        .response-area {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border: 2px dashed #dee2e6;
        }

        .business-response-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }

        .response-field {
            display: flex;
            flex-direction: column;
        }

        .response-field label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .response-field input,
        .response-field select,
        .response-field textarea {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .response-field.full-width {
            grid-column: 1 / -1;
        }

        .response-field small {
            color: #666;
            font-size: 12px;
            margin-top: 5px;
            font-style: italic;
        }
        textarea {
            width: 100%;
            min-height: 80px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: inherit;
            resize: vertical;
        }
        button {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #218838;
        }
        .log-area {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #dee2e6;
            max-height: 300px;
            overflow-y: auto;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            background: white;
            border-radius: 3px;
            font-size: 12px;
        }
        .current-question {
            background: #fff3cd;
            border-left-color: #ffc107;
        }
        .completed-question {
            background: #d4edda;
            border-left-color: #28a745;
        }
        .status {
            text-align: center;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.active {
            background: #d1ecf1;
            color: #0c5460;
        }
        .status.completed {
            background: #d4edda;
            color: #155724;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ¤– Interactive Chat Bot Testing</h1>
        <p><strong>Purpose:</strong> Test user responses to understand what intent, kind, and routing should happen for different queries.</p>
        
        <div id="status" class="status active">
            Ready to start testing
        </div>

        <div id="question-container">
            <!-- Questions will be dynamically inserted here -->
        </div>

        <div class="response-area">
            <h3>Your Response (as User):</h3>
            <textarea id="user-response" placeholder="Type your response as if you're a user asking the chatbot..."></textarea>
            <br>
            <button onclick="submitResponse()">Submit User Response</button>
            <button onclick="skipQuestion()">Skip Question</button>
        </div>

        <div class="response-area" id="business-response-section" style="display: none;">
            <h3>Business Owner Response (What Should Happen):</h3>
            <p><strong>As the business owner, what should the chatbot do with the user's follow-up response?</strong></p>
            <div class="business-response-grid">
                <div class="response-field">
                    <label for="expected-intent">Expected Intent:</label>
                    <select id="expected-intent">
                        <option value="advice">advice</option>
                        <option value="events">events</option>
                        <option value="booking">booking</option>
                        <option value="contact">contact</option>
                    </select>
                </div>
                <div class="response-field">
                    <label for="expected-kind">Expected Kind:</label>
                    <select id="expected-kind">
                        <option value="article">article</option>
                        <option value="product">product</option>
                        <option value="event">event</option>
                        <option value="service">service</option>
                        <option value="landing">landing</option>
                        <option value="mixed">mixed</option>
                    </select>
                </div>
                <div class="response-field full-width">
                    <label for="expected-urls">Expected URLs/Pages (one per line):</label>
                    <textarea id="expected-urls" placeholder="e.g., /courses/landscape-photography&#10;/workshops/bluebell-2024&#10;/private-lessons" rows="4"></textarea>
                    <small>Enter each URL on a separate line. These will become the links/pills in the chatbot response.</small>
                </div>
                <div class="response-field">
                    <label for="expected-response">Expected Response Type:</label>
                    <textarea id="expected-response" placeholder="Describe what the chatbot should respond with..." rows="3"></textarea>
                </div>
            </div>
            <button onclick="submitBusinessResponse()">Submit Business Response</button>
        </div>

        <div class="log-area">
            <h3>ðŸ“Š Testing Log</h3>
            <div id="log-container">
                <div class="log-entry">Testing session started...</div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 20px;">
            <button onclick="exportLog()">Export Test Results</button>
            <button onclick="clearLog()">Clear Log</button>
        </div>
    </div>

    <script>
        // Test questions array - 20 questions covering all content types
        const testQuestions = [
            {
                id: 1,
                userQuestion: "do you do photography courses?",
                chatbotResponse: "Yes, we provide photography courses! Can you be more specific as we do photography courses in Coventry and also have an online photography course.",
                category: "Generic Course Query",
                expectedIntent: "advice",
                expectedKind: "mixed"
            },
            {
                id: 2,
                userQuestion: "what beginners photography courses do you have?",
                chatbotResponse: "We have a comprehensive beginners photography course. What would you like to know about it?",
                category: "Specific Course Query",
                expectedIntent: "advice", 
                expectedKind: "product"
            },
            {
                id: 3,
                userQuestion: "do you run photography workshops?",
                chatbotResponse: "Yes, we run photography workshops! Can you be more specific about what type of workshop you're interested in?",
                category: "Generic Workshop Query",
                expectedIntent: "events",
                expectedKind: "event"
            },
            {
                id: 4,
                userQuestion: "what camera should I buy?",
                chatbotResponse: "I can help with camera recommendations! What type of photography are you interested in?",
                category: "Equipment Query",
                expectedIntent: "advice",
                expectedKind: "article"
            },
            {
                id: 5,
                userQuestion: "who is Alan Ranger?",
                chatbotResponse: "Alan Ranger is a professional photographer and tutor. What would you like to know about him?",
                category: "About Query",
                expectedIntent: "advice",
                expectedKind: "landing"
            },
            {
                id: 6,
                userQuestion: "what photography services do you offer?",
                chatbotResponse: "We offer various photography services. What type of service are you looking for?",
                category: "Service Query",
                expectedIntent: "advice",
                expectedKind: "service"
            },
            {
                id: 7,
                userQuestion: "is there a free online photography course?",
                chatbotResponse: "Yes! We have a free online photography course. Would you like to know more about it?",
                category: "Free Course Query",
                expectedIntent: "advice",
                expectedKind: "landing"
            },
            {
                id: 8,
                userQuestion: "when is the next bluebell photography workshop?",
                chatbotResponse: "We have bluebell photography workshops coming up. What would you like to know about them?",
                category: "Specific Workshop Query",
                expectedIntent: "events",
                expectedKind: "event"
            },
            {
                id: 9,
                userQuestion: "how do I use manual mode on my camera?",
                chatbotResponse: "Great question! Manual mode gives you full control. What specific aspect of manual mode would you like to learn about?",
                category: "Technical Photography Query",
                expectedIntent: "advice",
                expectedKind: "article"
            },
            {
                id: 10,
                userQuestion: "what's the best lens for portrait photography?",
                chatbotResponse: "Portrait photography has several great lens options. What's your budget range and camera system?",
                category: "Equipment Advice Query",
                expectedIntent: "advice",
                expectedKind: "article"
            },
            {
                id: 11,
                userQuestion: "do you offer one-to-one photography lessons?",
                chatbotResponse: "Yes, we offer private photography lessons! What type of photography would you like to focus on?",
                category: "Private Lesson Query",
                expectedIntent: "advice",
                expectedKind: "service"
            },
            {
                id: 12,
                userQuestion: "what's included in your landscape photography course?",
                chatbotResponse: "Our landscape photography course covers many aspects. What specific areas are you most interested in?",
                category: "Course Content Query",
                expectedIntent: "advice",
                expectedKind: "product"
            },
            {
                id: 13,
                userQuestion: "are your photography courses suitable for complete beginners?",
                chatbotResponse: "Absolutely! We have courses designed specifically for beginners. What type of photography interests you most?",
                category: "Beginner Suitability Query",
                expectedIntent: "advice",
                expectedKind: "landing"
            },
            {
                id: 14,
                userQuestion: "how much does the macro photography workshop cost?",
                chatbotResponse: "Our macro photography workshop has different pricing options. What would you like to know about the costs?",
                category: "Workshop Pricing Query",
                expectedIntent: "events",
                expectedKind: "event"
            },
            {
                id: 15,
                userQuestion: "what camera settings should I use for night photography?",
                chatbotResponse: "Night photography requires specific settings. What type of night photography are you planning?",
                category: "Technical Settings Query",
                expectedIntent: "advice",
                expectedKind: "article"
            },
            {
                id: 16,
                userQuestion: "do you have any photography courses in Birmingham?",
                chatbotResponse: "We run courses in various locations. What type of photography course are you looking for?",
                category: "Location-Specific Query",
                expectedIntent: "advice",
                expectedKind: "mixed"
            },
            {
                id: 17,
                userQuestion: "what's the difference between your online and in-person courses?",
                chatbotResponse: "Great question! We offer both formats with different benefits. What would you like to know about each?",
                category: "Course Format Comparison Query",
                expectedIntent: "advice",
                expectedKind: "mixed"
            },
            {
                id: 18,
                userQuestion: "can you help me choose between a DSLR and mirrorless camera?",
                chatbotResponse: "Both have their advantages! What's your main photography interest and experience level?",
                category: "Camera Type Advice Query",
                expectedIntent: "advice",
                expectedKind: "article"
            },
            {
                id: 19,
                userQuestion: "what photography workshops do you have coming up this month?",
                chatbotResponse: "We have several workshops scheduled this month. What type of photography workshop interests you?",
                category: "Upcoming Events Query",
                expectedIntent: "events",
                expectedKind: "event"
            },
            {
                id: 20,
                userQuestion: "how long have you been teaching photography?",
                chatbotResponse: "I've been teaching photography for many years. What would you like to know about my teaching experience?",
                category: "About/Experience Query",
                expectedIntent: "advice",
                expectedKind: "landing"
            }
        ];

        let currentQuestionIndex = 0;
        let testResults = [];

        function displayCurrentQuestion() {
            const question = testQuestions[currentQuestionIndex];
            const container = document.getElementById('question-container');
            
            container.innerHTML = `
                <div class="question current-question">
                    <h3>Question ${question.id}: ${question.category}</h3>
                    <p><strong>User asks:</strong> "${question.userQuestion}"</p>
                    <p><strong>Chatbot responds:</strong> "${question.chatbotResponse}"</p>
                    <p><strong>Now you respond as the user:</strong></p>
                    <p><strong>Expected Intent:</strong> ${question.expectedIntent} | <strong>Expected Kind:</strong> ${question.expectedKind}</p>
                </div>
            `;
            
            document.getElementById('user-response').value = '';
            document.getElementById('user-response').focus();
            
            updateStatus(`Question ${currentQuestionIndex + 1} of ${testQuestions.length} - ${question.category}`);
        }

        function submitResponse() {
            const response = document.getElementById('user-response').value.trim();
            if (!response) {
                alert('Please enter a response');
                return;
            }

            // Store the user response temporarily
            window.currentUserResponse = response;
            
            // Show the business response section
            document.getElementById('business-response-section').style.display = 'block';
            document.getElementById('user-response').disabled = true;
            document.querySelector('button[onclick="submitResponse()"]').disabled = true;
            
            logEntry(`Q${testQuestions[currentQuestionIndex].id}: User response submitted - "${response}"`, 'response');
            updateStatus(`Question ${currentQuestionIndex + 1} of ${testQuestions.length} - Now provide business owner response`);
        }

        function submitBusinessResponse() {
            const expectedIntent = document.getElementById('expected-intent').value;
            const expectedKind = document.getElementById('expected-kind').value;
            const expectedUrlsText = document.getElementById('expected-urls').value.trim();
            const expectedResponse = document.getElementById('expected-response').value.trim();

            if (!expectedUrlsText || !expectedResponse) {
                alert('Please fill in the Expected URLs and Expected Response fields');
                return;
            }

            // Parse URLs from textarea (one per line)
            const expectedUrls = expectedUrlsText.split('\n')
                .map(url => url.trim())
                .filter(url => url.length > 0);

            const question = testQuestions[currentQuestionIndex];
            const result = {
                questionId: question.id,
                category: question.category,
                userQuestion: question.userQuestion,
                chatbotResponse: question.chatbotResponse,
                userFollowUpResponse: window.currentUserResponse,
                businessOwnerResponse: {
                    expectedIntent: expectedIntent,
                    expectedKind: expectedKind,
                    expectedUrls: expectedUrls,
                    expectedResponse: expectedResponse
                },
                originalExpectedIntent: question.expectedIntent,
                originalExpectedKind: question.expectedKind,
                timestamp: new Date().toISOString()
            };

            testResults.push(result);
            logEntry(`Q${question.id}: Business response submitted - Intent: ${expectedIntent}, Kind: ${expectedKind}`, 'business');
            
            // Mark question as completed
            const container = document.getElementById('question-container');
            const urlsList = expectedUrls.map(url => `<li>${url}</li>`).join('');
            container.innerHTML = `
                <div class="question completed-question">
                    <h3>âœ… Question ${question.id}: ${question.category} - COMPLETED</h3>
                    <p><strong>User asked:</strong> "${question.userQuestion}"</p>
                    <p><strong>Chatbot responded:</strong> "${question.chatbotResponse}"</p>
                    <p><strong>User follow-up:</strong> "${window.currentUserResponse}"</p>
                    <p><strong>Business expects:</strong> Intent: ${expectedIntent}, Kind: ${expectedKind}</p>
                    <p><strong>Expected URLs (${expectedUrls.length}):</strong></p>
                    <ul>${urlsList}</ul>
                    <p><strong>Expected response:</strong> ${expectedResponse}</p>
                </div>
            `;

            // Reset for next question
            document.getElementById('business-response-section').style.display = 'none';
            document.getElementById('user-response').disabled = false;
            document.getElementById('user-response').value = '';
            document.querySelector('button[onclick="submitResponse()"]').disabled = false;
            document.getElementById('expected-intent').value = 'advice';
            document.getElementById('expected-kind').value = 'article';
            document.getElementById('expected-urls').value = '';
            document.getElementById('expected-response').value = '';

            currentQuestionIndex++;
            
            if (currentQuestionIndex < testQuestions.length) {
                setTimeout(() => {
                    displayCurrentQuestion();
                }, 2000);
            } else {
                updateStatus('All questions completed!');
                logEntry('ðŸŽ‰ All testing completed!', 'success');
            }
        }

        function skipQuestion() {
            const question = testQuestions[currentQuestionIndex];
            logEntry(`Q${question.id}: SKIPPED`, 'skip');
            
            currentQuestionIndex++;
            
            if (currentQuestionIndex < testQuestions.length) {
                displayCurrentQuestion();
            } else {
                updateStatus('All questions completed!');
                logEntry('ðŸŽ‰ All testing completed!', 'success');
            }
        }

        function logEntry(message, type = 'info') {
            const logContainer = document.getElementById('log-container');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            
            if (type === 'response') {
                entry.style.background = '#e7f3ff';
            } else if (type === 'success') {
                entry.style.background = '#d4edda';
            } else if (type === 'skip') {
                entry.style.background = '#fff3cd';
            }
            
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function updateStatus(message) {
            const status = document.getElementById('status');
            status.textContent = message;
            
            if (currentQuestionIndex >= testQuestions.length) {
                status.className = 'status completed';
            } else {
                status.className = 'status active';
            }
        }

        function exportLog() {
            const data = {
                testResults: testResults,
                timestamp: new Date().toISOString(),
                totalQuestions: testQuestions.length,
                completedQuestions: testResults.length
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `chatbot-test-results-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function clearLog() {
            if (confirm('Are you sure you want to clear the log?')) {
                document.getElementById('log-container').innerHTML = '<div class="log-entry">Log cleared...</div>';
                testResults = [];
                currentQuestionIndex = 0;
                displayCurrentQuestion();
            }
        }

        // Initialize
        displayCurrentQuestion();
    </script>
</body>
</html>
